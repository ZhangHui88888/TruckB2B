# XKTRUCK 外贸独立站 - 项目实施指南

本文档详细解释项目的技术实现原理、每个组件的作用，以及为什么这样设计。

---

## 目录

1. [整体架构设计](#一整体架构设计)
2. [前端技术选型](#二前端技术选型)
3. [数据库设计](#三数据库设计)
4. [产品数据同步](#四产品数据同步)
5. [AI 客服系统](#五ai-客服系统)
6. [SEO 优化策略](#六seo-优化策略)
7. [部署与运维](#七部署与运维)
8. [安全与成本](#八安全与成本)

---

## 一、整体架构设计

### 1.1 架构图解

```
┌─────────────────────────────────────────────────────────────┐
│                      用户（海外采购商）                        │
│                   浏览器 / WhatsApp / 搜索引擎                 │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│                   Cloudflare（全球边缘网络）                   │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐  │
│  │   Pages     │  │   Workers   │  │   R2 (备用)         │  │
│  │  静态网站   │  │  API后端    │  │   目前用Shopify CDN  │  │
│  │  (Astro)    │  │  (无服务器) │  │   存储产品图片       │  │
│  └─────────────┘  └─────────────┘  └─────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
                              ↓
        ┌─────────────────────┼─────────────────────┐
        ↓                     ↓                     ↓
┌───────────────┐     ┌───────────────┐     ┌───────────────┐
│   Supabase    │     │   DeepSeek    │     │    Resend     │
│   数据库      │     │   AI 大模型   │     │   邮件服务    │
│  - 产品数据   │     │  - 智能对话   │     │  - 询盘通知   │
│  - 知识库     │     │  - 内容生成   │     │  - 周报发送   │
│  - 向量检索   │     │               │     │               │
└───────────────┘     └───────────────┘     └───────────────┘
```

### 1.2 为什么选择这个架构？

#### 问题背景
传统外贸网站方案：
- **VPS 服务器**：需要运维、容易被攻击、国内访问海外慢
- **WordPress**：臃肿、安全漏洞多、SEO 需要大量插件
- **SaaS 建站**：月费高、定制性差、数据不可控

#### 解决方案：Serverless（无服务器）架构

| 优势 | 说明 |
|------|------|
| **零运维** | 不需要管理服务器，自动扩缩容 |
| **全球加速** | Cloudflare 300+ 节点，用户就近访问 |
| **成本极低** | 按使用量付费，小流量几乎免费 |
| **安全性高** | 自带 DDoS 防护、WAF、SSL |
| **SEO 友好** | 静态生成，加载速度快 |

#### 核心理念：边缘计算

```
传统架构：用户 → 中心服务器（可能在美国）→ 返回数据
边缘架构：用户 → 最近的边缘节点（可能在用户城市）→ 返回数据
```

Cloudflare 的边缘节点遍布全球，用户请求会被路由到最近的节点，大幅降低延迟。

---

## 二、前端技术选型

### 2.1 为什么选择 Astro？

#### 对比主流框架

| 框架 | 特点 | 适用场景 | 缺点 |
|------|------|----------|------|
| **React/Vue SPA** | 单页应用，交互丰富 | 后台管理系统 | SEO 差，首屏慢 |
| **Next.js/Nuxt** | SSR 服务端渲染 | 动态内容网站 | 需要服务器，成本高 |
| **Astro** | 静态生成 + 部分水合 | 内容型网站 | 不适合高交互应用 |

#### Astro 的核心优势

**1. 零 JavaScript 默认**
```astro
<!-- 这个组件不会发送任何 JS 到浏览器 -->
<ProductCard title="VOLVO Headlamp" price="$299" />
```

传统 React：即使是静态内容，也会发送整个 React 运行时（~40KB）
Astro：只发送 HTML，JS 为 0

**2. 部分水合（Partial Hydration）**
```astro
<!-- 只有这个组件会加载 JS，且只在可见时加载 -->
<ChatWidget client:visible />
```

可以精确控制哪些组件需要交互，其他保持静态。

**3. 构建时数据获取**
```astro
---
// 这段代码在构建时运行，不是在用户浏览器中
const products = await supabase.from('products').select('*');
---

{products.map(p => <ProductCard product={p} />)}
```

产品数据在构建时就已经嵌入 HTML，用户访问时无需等待 API 请求。

### 2.2 为什么选择 TailwindCSS？

#### 传统 CSS 的问题

```css
/* styles.css - 随着项目增长，CSS 文件越来越大 */
.product-card { ... }
.product-card-title { ... }
.product-card-title-featured { ... }
.product-card-image { ... }
/* 最终可能有几千行，很多是重复的 */
```

#### Tailwind 的解决方案

```html
<!-- 直接在 HTML 中写样式，无需命名 -->
<div class="bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition">
  <h3 class="text-xl font-bold text-gray-900">Product Title</h3>
</div>
```

**优势：**
1. **无需命名**：不用想 `.product-card-wrapper-inner` 这种名字
2. **自动精简**：构建时只保留用到的样式，最终 CSS 很小
3. **一致性**：预定义的间距、颜色系统，设计更统一
4. **响应式简单**：`md:flex lg:grid` 轻松适配不同屏幕

### 2.3 项目文件结构解释

```
xk-truck-frontend/
├── src/
│   ├── components/          # 可复用组件
│   │   ├── Header.astro     # 网站头部导航
│   │   ├── Footer.astro     # 网站底部
│   │   └── ChatWidget.astro # AI 聊天浮窗
│   │
│   ├── layouts/             # 页面布局模板
│   │   ├── Layout.astro     # 主布局（包含 SEO meta 标签）
│   │   └── AdminLayout.astro # 后台布局
│   │
│   ├── pages/               # 页面文件（自动生成路由）
│   │   ├── index.astro      # / 首页
│   │   ├── about.astro      # /about 关于页
│   │   ├── contact.astro    # /contact 联系页
│   │   ├── products/
│   │   │   ├── index.astro  # /products 产品列表
│   │   │   └── [id].astro   # /products/xxx 产品详情（动态路由）
│   │   └── admin/           # /admin/* 后台管理
│   │
│   └── lib/
│       └── supabase.ts      # Supabase 客户端和数据获取函数
│
├── public/                  # 静态资源（直接复制到输出）
│   ├── robots.txt           # 搜索引擎爬虫规则
│   └── favicon.svg          # 网站图标
│
├── scripts/                 # 工具脚本
│   ├── sync-products-simple.js  # 产品数据同步
│   └── supabase-schema.sql      # 数据库表结构
│
└── astro.config.mjs         # Astro 配置文件
```

#### 路由系统原理

Astro 使用**文件系统路由**：

```
src/pages/index.astro        → https://xk-truck.cn/
src/pages/about.astro        → https://xk-truck.cn/about
src/pages/products/index.astro → https://xk-truck.cn/products
src/pages/products/[id].astro  → https://xk-truck.cn/products/任意ID
```

`[id].astro` 是**动态路由**，方括号表示这是一个参数，可以匹配任意值。

---

## 三、数据库设计

### 3.1 为什么选择 Supabase？

#### 对比其他数据库方案

| 方案 | 优点 | 缺点 |
|------|------|------|
| **MySQL/PostgreSQL 自建** | 完全控制 | 需要运维，成本高 |
| **Firebase** | 实时同步 | 查询能力弱，锁定 Google |
| **MongoDB Atlas** | 灵活 schema | 关系查询弱 |
| **Supabase** | PostgreSQL + 向量 + 实时 + Auth | 免费额度有限 |

#### Supabase 的独特优势

**1. 原生 PostgreSQL**
- 强大的 SQL 查询能力
- 支持复杂的关联查询
- 成熟稳定的数据库引擎

**2. 内置向量搜索（pgvector）**
```sql
-- 可以直接在 PostgreSQL 中做向量相似度搜索
SELECT * FROM knowledge_base
ORDER BY embedding <-> query_embedding
LIMIT 5;
```

这对 AI 客服的知识库检索至关重要。

**3. 自动生成 REST API**
```javascript
// 不需要写后端代码，直接调用
const { data } = await supabase
  .from('products')
  .select('*')
  .eq('brand_slug', 'volvo');
```

**4. 实时订阅**
```javascript
// 数据变化时自动推送
supabase
  .channel('inquiries')
  .on('INSERT', payload => {
    console.log('新询盘:', payload.new);
  })
  .subscribe();
```

### 3.2 数据库表结构设计

#### 核心表关系图

```
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│   brands    │     │  products   │     │ categories  │
│  品牌表     │────<│   产品表    │>────│   分类表    │
│             │     │             │     │             │
│ id          │     │ id          │     │ id          │
│ name        │     │ name        │     │ name        │
│ slug        │     │ brand_id    │     │ slug        │
│ logo_url    │     │ category_id │     │ description │
└─────────────┘     │ oe_number   │     └─────────────┘
                    │ main_image  │
                    │ images[]    │
                    │ specs{}     │
                    └─────────────┘
```

#### 为什么这样设计？

**1. 品牌和分类独立成表**
```sql
-- 不好的设计：品牌直接存字符串
products: { brand: "VOLVO", ... }

-- 好的设计：通过外键关联
products: { brand_id: "uuid-xxx", ... }
brands: { id: "uuid-xxx", name: "VOLVO", logo_url: "..." }
```

优势：
- 品牌信息（logo、描述）只存一份，不重复
- 修改品牌名只需改一处
- 可以方便地统计每个品牌的产品数量

**2. 使用 slug 作为 URL 标识**
```
slug: "volvo-fh4-led-headlamp"
URL:  /products/volvo-fh4-led-headlamp
```

而不是用 UUID：
```
id:  "550e8400-e29b-41d4-a716-446655440000"
URL: /products/550e8400-e29b-41d4-a716-446655440000  # 丑陋且不利于 SEO
```

**3. 使用 JSONB 存储灵活数据**
```sql
specifications JSONB  -- {"weight": "2.5kg", "voltage": "24V", ...}
features TEXT[]       -- ["LED", "DOT Certified", "Waterproof"]
```

不同产品的规格参数不同，用 JSONB 可以灵活存储，无需为每个参数建列。

### 3.3 知识库表设计（RAG 用）

```sql
CREATE TABLE knowledge_base (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  content TEXT NOT NULL,           -- 原始文本内容
  embedding VECTOR(1536),          -- 向量表示（1536 维）
  metadata JSONB,                  -- 元数据（来源、类型等）
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- 创建向量索引，加速相似度搜索
CREATE INDEX ON knowledge_base 
USING ivfflat (embedding vector_cosine_ops)
WITH (lists = 100);
```

#### 什么是向量（Embedding）？

```
文本: "VOLVO FH4 大灯支持 LED 和卤素两种光源"
      ↓ 通过 AI 模型转换
向量: [0.023, -0.156, 0.089, ..., 0.045]  # 1536 个数字
```

向量是文本的"数学表示"，语义相近的文本，向量也相近。

#### 为什么需要向量搜索？

传统关键词搜索：
```sql
SELECT * FROM faq WHERE content LIKE '%大灯%';
-- 只能匹配包含"大灯"的内容
-- 搜"headlamp"就找不到了
```

向量搜索：
```sql
SELECT * FROM knowledge_base
ORDER BY embedding <-> query_embedding  -- 计算向量距离
LIMIT 5;
-- "大灯"和"headlamp"的向量相近，都能匹配到
```

---

## 四、产品数据同步

### 4.1 数据来源

产品数据从 xklamp.com（现有 Shopify 网站）抓取：

```
xklamp.com/zh/collections/volvo/products.json
         ↓ 抓取
    解析产品信息
         ↓ 转换
    存入 Supabase
         ↓ 
    图片 URL 保持使用 Shopify CDN
```

### 4.2 同步脚本原理

```javascript
// scripts/sync-products-simple.js 核心逻辑

// 1. 定义品牌映射
const brandMapping = {
  'volvo': 'volvo',
  'benz': 'mercedes-benz',  // xklamp 用 benz，我们用 mercedes-benz
  // ...
};

// 2. 遍历每个品牌，获取产品
for (const [collection, brandSlug] of Object.entries(brandMapping)) {
  const url = `https://xklamp.com/zh/collections/${collection}/products.json`;
  const response = await fetch(url);
  const { products } = await response.json();
  
  // 3. 转换数据格式
  for (const product of products) {
    const transformed = {
      name: product.title,
      slug: product.handle,
      oe_number: extractOENumber(product),  // 从标题或描述提取 OE 号
      main_image_url: product.images[0]?.src,
      images: product.images.map(img => img.src),
      brand_id: brandIdMap[brandSlug],
      // ...
    };
    
    // 4. 插入或更新到 Supabase
    await supabase.from('products').upsert(transformed);
  }
}
```

### 4.3 为什么不上传图片到 R2？

**方案对比：**

| 方案 | 优点 | 缺点 |
|------|------|------|
| **使用 Shopify CDN** | 零成本、零维护 | 依赖 xklamp.com |
| **上传到 R2** | 完全独立 | 需要下载上传、占用存储 |

当前选择使用 Shopify CDN，因为：
1. xklamp.com 是自己的网站，不会下线
2. Shopify CDN 本身就是全球加速的
3. 节省 R2 存储空间和流量

如果将来需要独立，可以运行 `sync-products.js`（完整版）上传到 R2。

---

## 五、AI 客服系统

### 5.1 RAG 架构原理

RAG = Retrieval Augmented Generation（检索增强生成）

```
用户提问: "VOLVO FH4 大灯多少钱？"
              ↓
┌─────────────────────────────────────────────────────────────┐
│ 1. 向量化查询                                                │
│    "VOLVO FH4 大灯多少钱？" → [0.12, -0.34, ...]            │
└─────────────────────────────────────────────────────────────┘
              ↓
┌─────────────────────────────────────────────────────────────┐
│ 2. 知识库检索（Supabase 向量搜索）                           │
│    找到相关内容:                                             │
│    - "VOLVO FH4 LED 大灯，OE: 21221129，价格区间 $200-400"  │
│    - "FH4 系列支持 LED 和卤素两种规格..."                    │
└─────────────────────────────────────────────────────────────┘
              ↓
┌─────────────────────────────────────────────────────────────┐
│ 3. 构建 Prompt                                               │
│    System: 你是 XKTRUCK 的客服，根据以下知识回答问题...      │
│    Context: [检索到的相关内容]                               │
│    User: VOLVO FH4 大灯多少钱？                              │
└─────────────────────────────────────────────────────────────┘
              ↓
┌─────────────────────────────────────────────────────────────┐
│ 4. 调用 DeepSeek API 生成回答                                │
│    "VOLVO FH4 大灯价格在 $200-400 之间，具体取决于..."       │
└─────────────────────────────────────────────────────────────┘
```

### 5.2 为什么需要 RAG？

**直接问 AI 的问题：**
```
用户: VOLVO FH4 大灯多少钱？
AI: 抱歉，我没有最新的价格信息...（AI 不知道你的产品）
```

**使用 RAG：**
```
用户: VOLVO FH4 大灯多少钱？
AI: 根据我们的产品目录，VOLVO FH4 LED 大灯价格在 $200-400...
    （AI 基于你提供的知识库回答）
```

RAG 让 AI 能够回答**你的业务特定问题**，而不是泛泛而谈。

### 5.3 Cloudflare Worker 实现

```javascript
// Worker 处理流程
export default {
  async fetch(request, env) {
    const { message, history } = await request.json();
    
    // 1. 向量化用户问题
    const embedding = await getEmbedding(message, env.DEEPSEEK_KEY);
    
    // 2. 检索相关知识
    const relevantDocs = await searchKnowledge(embedding, env.SUPABASE);
    
    // 3. 构建 prompt
    const prompt = buildPrompt(message, history, relevantDocs);
    
    // 4. 调用 AI
    const response = await callDeepSeek(prompt, env.DEEPSEEK_KEY);
    
    // 5. 返回结果
    return new Response(JSON.stringify({ reply: response }));
  }
};
```

### 5.4 为什么选择 DeepSeek？

| 模型 | 价格（每百万 token） | 性能 |
|------|----------------------|------|
| GPT-4o | $5 / $15 | 最强 |
| GPT-4o-mini | $0.15 / $0.60 | 很强 |
| Claude 3.5 | $3 / $15 | 很强 |
| **DeepSeek** | **$0.27 / $1.10** | 接近 GPT-4o |

DeepSeek 性价比最高，对于客服场景完全够用。

### 5.5 对话记录存储

```sql
CREATE TABLE conversations (
  id UUID PRIMARY KEY,
  phone TEXT,              -- WhatsApp 号码（如果来自 WhatsApp）
  session_id TEXT,         -- 网页会话 ID
  message TEXT NOT NULL,
  direction TEXT,          -- 'incoming' 或 'outgoing'
  is_ai BOOLEAN,           -- 是否 AI 回复
  timestamp TIMESTAMPTZ
);
```

存储对话的目的：
1. **训练改进**：分析用户常问问题，完善知识库
2. **人工接管**：AI 回答不好时，人工可以查看上下文
3. **数据分析**：了解客户关注点

---

## 六、SEO 优化策略

### 6.1 为什么 SEO 对外贸网站重要？

```
外贸获客渠道对比：

Google 搜索（SEO）
├── 成本：低（一次投入，长期收益）
├── 信任度：高（用户主动搜索）
└── 转化率：高

Google 广告（SEM）
├── 成本：高（持续付费）
├── 信任度：中（广告标识）
└── 转化率：中

社交媒体
├── 成本：中
├── 信任度：低
└── 转化率：低
```

SEO 是外贸网站最重要的流量来源。

### 6.2 技术 SEO 实现

#### 6.2.1 Meta 标签

```astro
<!-- src/layouts/Layout.astro -->
<head>
  <title>{title} | XKTRUCK</title>
  <meta name="description" content={description} />
  
  <!-- Open Graph（社交分享） -->
  <meta property="og:title" content={title} />
  <meta property="og:description" content={description} />
  <meta property="og:image" content={image} />
  
  <!-- 规范链接（避免重复内容） -->
  <link rel="canonical" href={canonicalUrl} />
</head>
```

**作用：**
- `title`：搜索结果中显示的标题
- `description`：搜索结果中的描述文字
- `og:*`：在 Facebook/LinkedIn 分享时显示的内容
- `canonical`：告诉搜索引擎这是页面的"官方"URL

#### 6.2.2 结构化数据（Schema.org）

```json
{
  "@context": "https://schema.org",
  "@type": "Product",
  "name": "VOLVO FH4 LED Headlamp",
  "image": "https://...",
  "description": "...",
  "sku": "XK-VL-001",
  "mpn": "21221129",
  "brand": {
    "@type": "Brand",
    "name": "VOLVO"
  },
  "offers": {
    "@type": "Offer",
    "priceCurrency": "USD",
    "price": "299",
    "availability": "https://schema.org/InStock"
  }
}
```

**作用：**
让 Google 理解页面内容，可能显示富媒体搜索结果：

```
普通搜索结果：
VOLVO FH4 LED Headlamp - XKTRUCK
High quality LED headlamp for VOLVO FH4...

富媒体搜索结果：
VOLVO FH4 LED Headlamp - XKTRUCK    ⭐⭐⭐⭐⭐ (23 reviews)
$299 · In Stock
High quality LED headlamp for VOLVO FH4...
[图片缩略图]
```

#### 6.2.3 Sitemap

```xml
<!-- sitemap-index.xml -->
<sitemapindex>
  <sitemap>
    <loc>https://xk-truck.cn/sitemap-0.xml</loc>
  </sitemap>
</sitemapindex>

<!-- sitemap-0.xml -->
<urlset>
  <url>
    <loc>https://xk-truck.cn/</loc>
    <lastmod>2024-12-11</lastmod>
  </url>
  <url>
    <loc>https://xk-truck.cn/products</loc>
  </url>
  <!-- 所有页面... -->
</urlset>
```

**作用：**
告诉搜索引擎网站有哪些页面，帮助更快、更全面地索引。

#### 6.2.4 robots.txt

```
User-agent: *
Allow: /

# AI 搜索引擎爬虫
User-agent: GPTBot
Allow: /

User-agent: ClaudeBot
Allow: /

Sitemap: https://xk-truck.cn/sitemap-index.xml
```

**作用：**
- 告诉爬虫哪些页面可以抓取
- 指向 sitemap 位置
- 允许 AI 搜索引擎（ChatGPT、Perplexity 等）抓取

### 6.3 GEO（生成式引擎优化）

GEO 是针对 AI 搜索引擎的优化，这是新兴领域。

**传统 SEO vs GEO：**

| 方面 | SEO（Google） | GEO（ChatGPT/Perplexity） |
|------|---------------|---------------------------|
| 目标 | 排名靠前 | 被 AI 引用 |
| 内容 | 关键词优化 | 结构化、易于提取 |
| 格式 | HTML 页面 | 清晰的问答格式 |

**GEO 优化策略：**
1. 使用清晰的标题层级（H1/H2/H3）
2. 提供结构化的产品规格
3. 包含常见问题（FAQ）
4. 允许 AI 爬虫访问

---

## 七、部署与运维

### 7.1 Cloudflare Pages 部署流程

```
GitHub 仓库
    ↓ push 代码
Cloudflare Pages 自动构建
    ↓ npm run build
生成静态文件
    ↓ 部署到边缘节点
全球 300+ 节点可访问
```

**配置步骤：**
1. 连接 GitHub 仓库
2. 设置构建命令：`npm run build`
3. 设置输出目录：`dist`
4. 配置环境变量
5. 绑定自定义域名

### 7.2 环境变量管理

```
开发环境（本地）：
.env 文件（不提交到 Git）

生产环境（Cloudflare）：
Pages Settings → Environment variables
```

**需要配置的变量：**

| 变量名 | 用途 | 在哪里获取 |
|--------|------|------------|
| `PUBLIC_SUPABASE_URL` | 数据库连接 | Supabase 控制台 |
| `PUBLIC_SUPABASE_ANON_KEY` | 数据库公钥 | Supabase 控制台 |
| `DEEPSEEK_API_KEY` | AI 模型 | DeepSeek 控制台 |
| `RESEND_API_KEY` | 邮件发送 | Resend 控制台 |

### 7.3 自动化工作流

```yaml
# .github/workflows/seo-auto-update.yml
name: SEO Auto Update
on:
  schedule:
    - cron: '0 1 * * 1'  # 每周一 UTC 1:00（北京 9:00）

jobs:
  update-seo:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - run: npm install
      - run: node scripts/seo-auto-update.js
        env:
          GSC_CREDENTIALS: ${{ secrets.GSC_CREDENTIALS }}
          # ...
```

**工作流程：**
1. 每周自动运行
2. 从 Google Search Console 获取搜索数据
3. AI 分析优化建议
4. 更新 Supabase 中的 SEO 配置
5. 触发网站重建
6. 发送周报邮件

---

## 八、安全与成本

### 8.1 安全措施

#### API Key 保护
```
❌ 错误：硬编码在代码中
const apiKey = "sk-xxxxx";

✅ 正确：使用环境变量
const apiKey = process.env.DEEPSEEK_API_KEY;
```

#### 数据库权限
```sql
-- Supabase RLS（行级安全）
-- 只允许读取 is_active = true 的产品
CREATE POLICY "Public read active products"
ON products FOR SELECT
USING (is_active = true);
```

#### Cloudflare 防护
- 自动 DDoS 防护
- WAF（Web 应用防火墙）
- Bot 管理
- SSL/TLS 加密

### 8.2 成本估算

#### 免费额度

| 服务 | 免费额度 | 预计使用 |
|------|----------|----------|
| Cloudflare Pages | 无限带宽 | ✅ 足够 |
| Cloudflare Workers | 10万请求/天 | ✅ 足够 |
| Cloudflare R2 | 10GB 存储 | ✅ 足够 |
| Supabase | 500MB 数据库 | ✅ 足够 |
| Resend | 100封/天 | ✅ 足够 |

#### 付费部分

| 服务 | 费用 | 说明 |
|------|------|------|
| 域名 | ~¥50/年 | xk-truck.cn |
| DeepSeek API | ~$5-20/月 | 按使用量 |
| **总计** | **~¥100-200/月** | |

对比传统方案（VPS + 运维）节省 80% 以上成本。

---

## 附录：常见问题

### Q1: 为什么不用 WordPress？

WordPress 是通用 CMS，对于这个项目：
- 过于臃肿（我们只需要展示产品）
- 安全风险高（需要持续更新）
- SEO 需要大量插件
- 需要服务器运维

Astro + Cloudflare 更轻量、更安全、更便宜。

### Q2: 数据更新后网站如何刷新？

Astro 是静态生成的，数据更新后需要重新构建：
1. 手动：Cloudflare Pages → Deployments → Retry
2. 自动：配置 Deploy Hook，数据更新时触发

### Q3: AI 客服会不会乱说话？

通过以下方式控制：
1. **System Prompt**：明确告诉 AI 它的角色和限制
2. **RAG**：只基于知识库内容回答
3. **人工兜底**：AI 不确定时引导联系人工

### Q4: 如何添加新产品？

1. 在 xklamp.com 添加产品
2. 运行 `npm run sync:products` 同步到 Supabase
3. 触发网站重建

或者直接在 Supabase 控制台手动添加。

---

*文档版本: 1.0*
*最后更新: 2024-12-11*
